platform :ios, '16.0' # iOS 16 required for React Native 0.81.0 React-graphics

require_relative '../node_modules/react-native/scripts/react_native_pods'

use_frameworks! :linkage => :static

# Add permissions configuration
permissions_path = '../node_modules/react-native-permissions/ios'

target 'GaterLinkNative' do
  use_react_native!(
    :path => '../node_modules/react-native',
    :hermes_enabled => true,   # Hermes is default in RN 0.81
    :fabric_enabled => false   # Keep Old Arch since using Reanimated 3.19.1
  )

  # Firebase 12+ (using default subspecs, no modular headers)
  pod 'Firebase/Auth'
  pod 'Firebase/Firestore'

  # React Native Permissions - will be handled by the main package

  post_install do |installer|
    react_native_post_install(installer)

    # Xcode 16: avoid sandboxing failures in RN/Hermes build phases
    (installer.pods_project.targets + installer.generated_projects.flat_map(&:targets)).each do |t|
      t.build_configurations.each do |cfg|
        cfg.build_settings['ENABLE_USER_SCRIPT_SANDBOXING'] = 'NO'
      end
    end
  end
end
